# BookStore 总体设计文档

## 程序功能概述

本程序为一个基于命令行的书店管理系统，使用 C++ 实现。具体地，本程序为书店店长、员工和顾客服务，支持账号注册、登录、注销功能、图书查询、购买功能。对于员工，还提供修改图书信息、进货、账户管理功能；对于店长，还提供查看书店日志、管理财务情况等功能。

本程序使用文件存储，将账户、图书与日志信息保存在外存上。首次运行时，本程序将会自动创建店长账号。本程序支持嵌套登录，指令视为最后一个登录人员的操作。程序开始运行或没有账号登录时，视为游客账号，只能进行注册或登录操作。

计划实现图形用户界面。

## 程序逻辑概述

本程序采用面向对象编程，包含以下模块：

- 文件读写系统
- 账户及其管理系统
- 书籍及其管理系统
- 日志及其管理系统
- 指令解析模块
- 主程序

运行时，指令解析器解析指令，按要求把指令分发到账户 / 书籍 / 日志管理系统，通过文件读写完成指令，进行输出。

## 代码文件结构

1. `memory_river.hpp`

    实现了基本的线性文件读写类，包含文件随机读取、更新、写入功能。

2. `hash_map.hpp`

    实现了文件存储的哈希表模板类，支持修改键值类型、值类型、哈希函数、哈希桶规模等，包含插入、删除、查询键值对等功能。

3. `account.hpp`, `account.cpp`

    实现了账户类型，用于存储账户信息，提供了验证与修改密码、查询权限功能。

    实现了账户管理系统，包含注册、修改、查找、删除账户功能。

4. `book.hpp`, `book.cpp`

    实现了图书类型，用于存储图书信息。

    实现了图书管理系统，包含选择、查询、修改、购买、进货图书功能。

5. `log.hpp`, `log.cpp`

    实现了日志类型，包含财务日志、员工日志和操作日志三类，分别保存系统收支情况、员工工作记录和所有操作的日志。

    实现了日志管理系统，包含写入日志、查询财务情况、生成财务报表、生成员工工作表、查询日志等功能。

6. `validator.hpp`, `validator.cpp`

    实现了字符串判断类，包含判断字符串长度、是否只包含特定字符等功能，用于判断字段合法性。

7. `utils.hpp`, `utils.cpp`

    实现了程序需要的其他工具函数（包括 `std::array` 和 `std::string` 的相互转换、查询系统时间、解析命令参数等函数）。

8. `code.cpp`

    主程序，包含指令解析模块和指令执行模块。

## 功能设计